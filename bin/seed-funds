#!/usr/bin/env node

const config = require('../config')
const mongoose = require('mongoose')
const Fund = require('../models/fund')

console.log('Database:', config.mongoUrl)

const funds = [
  { name: "C", description: "U.S. large cap fund", inceptionDate: new Date(Date.UTC(1988, 00, 29)), active: true },
  { name: "S", description: "U.S. small/medium cap fund", inceptionDate: new Date(Date.UTC(2001, 04, 01)), active: true },
  { name: "I", description: "International stock fund", inceptionDate: new Date(Date.UTC(2001, 04, 01)), active: true }
]

mongoose.connect(config.mongoUrl, async (err, db) => {
  const newFunds = []
  for (let fund of funds) {
    if (await Fund.findOne({ name: fund.name })) {
      console.log(`${fund.name} Fund already exists, skipping`)
    } else {
      console.log(`Adding: ${fund.name} Fund`)
      newFunds.push(fund)
    }
  }
  await Fund.create(newFunds)
  mongoose.connection.close()
})
